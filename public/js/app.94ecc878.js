(function(e){function t(t){for(var a,r,i=t[0],l=t[1],c=t[2],d=0,p=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,i=1;i<n.length;i++){var l=n[i];0!==s[l]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},s={app:0},o=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-app-bar",{attrs:{app:"",color:"blue darken-3",dark:""}},[n("v-toolbar-title",{staticClass:"headline text-uppercase"},[n("span",[e._v("Voting for BEST Knowledge")])]),n("v-spacer"),n("v-btn",{attrs:{icon:"",color:"white lighten-2"}},[n("router-link",{attrs:{to:{name:"voteresult"}}},[n("v-icon",[e._v("note")])],1)],1),e.isSignIn?n("v-btn",{attrs:{icon:"",color:"white lighten-2"},on:{click:e.signout}},[n("v-icon",[e._v("exit_to_app")])],1):e._e()],1),n("v-content",[n("router-view")],1)],1)},o=[],r=n("2f62");a["a"].use(r["a"]);var i=new r["a"].Store({modules:{auth:{namespaced:!0,state:{isSignIn:!1},mutations:{setSignIn(e,t){e.isSignIn=t}},getters:{isSignIn(e){return e.isSignIn}},actions:{}}}}),l={name:"App",data(){return{}},computed:{...Object(r["b"])({isSignIn:"auth/isSignIn"})},methods:{signout:function(){i.commit("auth/setSignIn",!1),localStorage.removeItem("token"),this.$router.push("/signin")}}},c=l,u=n("2877"),d=n("6544"),p=n.n(d),m=n("7496"),h=n("40dc"),g=n("8336"),v=n("a75b"),f=n("132d"),k=n("2fa4"),b=n("2a7f"),w=Object(u["a"])(c,s,o,!1,null,null,null),y=w.exports;p()(w,{VApp:m["a"],VAppBar:h["a"],VBtn:g["a"],VContent:v["a"],VIcon:f["a"],VSpacer:k["a"],VToolbarTitle:b["a"]});var x=n("8c4f"),_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",[n("h2",{staticClass:"headline font-weight-bold mb-3 text-center"},[e._v("SignUp")]),n("div",[e._v(e._s(e.message))]),n("v-text-field",{attrs:{"prepend-icon":"person",label:"ユーザ名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("v-text-field",{attrs:{"prepend-icon":"lock",label:"パスワード",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("v-card-actions",[n("v-btn",{attrs:{primary:"",large:"",block:""},on:{click:e.signUp}},[e._v("SignUp")])],1)],1)},S=[],V=n("bc3a"),I=n.n(V),$={name:"Signup",data(){return{message:"",username:"",password:""}},methods:{signUp:function(){I.a.post("http://localhost:8080/signup",{name:this.username,password:this.password}).then(e=>{this.message="ユーザを作成しました",this.$router.push({path:"/signin"}),console.log(e)},e=>{console.log(e),this.message="サインアップに失敗しました。既に登録済みかユーザ名またはパスワードが空です"})}}},C=$,O=n("99d9"),j=n("4bd4"),L=n("8654"),T=Object(u["a"])(C,_,S,!1,null,null,null),B=T.exports;p()(T,{VBtn:g["a"],VCardActions:O["a"],VForm:j["a"],VTextField:L["a"]});var E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",[n("h2",{staticClass:"headline font-weight-bold mb-3 text-center"},[e._v("SignIn")]),n("div",[e._v(e._s(e.message))]),n("v-text-field",{attrs:{"prepend-icon":"person",label:"ユーザ名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("v-text-field",{attrs:{"prepend-icon":"lock",label:"パスワード",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("v-card-actions",[n("v-btn",{attrs:{primary:"",large:"",block:""},on:{click:e.signIn}},[e._v("SignIn")])],1),n("router-link",{attrs:{to:"/signup"}},[n("h2",{staticClass:"headline font-weight-bold mb-3 text-center"},[e._v("未登録の方はこちら")])])],1)},A=[],D={name:"Signin",data(){return{message:"",username:"",password:""}},methods:{signIn:function(){I.a.post("http://localhost:8080/signin",{name:this.username,password:this.password}).then(e=>{localStorage.setItem("token",e.data.token),i.commit("auth/setSignIn",!0),this.$router.push("/")},e=>{console.log(e),this.message="ログインに失敗しました。ユーザ名またはパスワードが違います"})}}},P=D,U=Object(u["a"])(P,E,A,!1,null,null,null),R=U.exports;p()(U,{VBtn:g["a"],VCardActions:O["a"],VForm:j["a"],VTextField:L["a"]});var F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.knowledges,"single-select":e.singleSelect,"item-key":"id","show-select":"",dense:"",loading:e.isLoading,"hide-default-footer":!0},scopedSlots:e._u([{key:"item.reason",fn:function(t){return[n("v-edit-dialog",{attrs:{"return-value":t.item.reason,large:"",persist:""},on:{"update:returnValue":function(n){return e.$set(t.item,"reason",n)},"update:return-value":function(n){return e.$set(t.item,"reason",n)},save:e.save,cancel:e.cancel,open:e.open,close:e.close},scopedSlots:e._u([{key:"input",fn:function(){return[n("v-radio-group",{model:{value:t.item.reason,callback:function(n){e.$set(t.item,"reason",n)},expression:"props.item.reason"}},[n("v-radio",{attrs:{label:"技術的",value:"技術的"}}),n("v-radio",{attrs:{label:"面白い",value:"面白い"}}),n("v-radio",{attrs:{label:"役に立った",value:"役に立った"}}),n("v-radio",{attrs:{label:"その他",value:"その他"}})],1)]},proxy:!0}],null,!0)},[e._v("\n          "+e._s(t.item.reason)+"\n          ")])]}},{key:"item.comment",fn:function(t){return[n("v-edit-dialog",{attrs:{"return-value":t.item.comment},on:{"update:returnValue":function(n){return e.$set(t.item,"comment",n)},"update:return-value":function(n){return e.$set(t.item,"comment",n)},save:e.save,cancel:e.cancel,open:e.open,close:e.close},scopedSlots:e._u([{key:"input",fn:function(){return[n("v-text-field",{attrs:{label:"Edit","single-line":"",autofocus:""},model:{value:t.item.comment,callback:function(n){e.$set(t.item,"comment",n)},expression:"props.item.comment"}})]},proxy:!0}],null,!0)},[e._v("\n          "+e._s(t.item.comment)+"\n          ")])]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1),n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[n("div",[e._v(e._s(e.message))])]),n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[n("v-btn",{attrs:{large:"",color:"primary"},on:{click:e.postLike}},[e._v("投票")])],1)],1)},q=[];const K="localhost:8080",M=`http://${K}/api`,J=localStorage.getItem("token");var z=I.a.create({baseURL:M,headers:{Authorization:`Bearer ${J}`}});const G="/knowledge";var H={get(){return z.get(`${G}`)},createKnowledge(e){return z.post(`${G}`,e)}};const N="/like";var Q={get(){return z.get(`${N}`)},getByUserID(){return z.get(`${N}/my`)},getByKnowledgeID(e){return z.get(`${N}/${e}`)},createLike(e){return z.post(`${N}`,e)},deleteLike(){return z.delete(`${N}/my`)}};const W={knowledge:H,like:Q},X={get:e=>W[e]},Y=X.get("knowledge"),Z=X.get("like");var ee={data(){return{singleSelect:!1,snack:!1,snackColor:"",snackText:"",selected:[],headers:[{text:"タイトル",value:"title"},{text:"作成者",value:"author"},{text:"理由",value:"reason"},{text:"コメント(あれば)",value:"comment"}],isLoading:!1,knowledges:[],likes:[],message:"",predelete:!0}},computed:{...Object(r["b"])({isSignIn:"auth/isSignIn"})},created(){this.fetch(),this.likefetch()},methods:{async fetch(){this.isLoading=!0;const{data:e}=await Y.get();this.isLoading=!1,this.knowledges=e},async likefetch(){const{data:e}=await Z.getByUserID();if(0!==e.length){this.likes=e;for(let e in this.knowledges)for(let t of this.likes)this.knowledges[e].id===t.knowledgeId&&(this.knowledges[e].reason=t.reason,this.knowledges[e].comment=t.comment,t.id=t.knowledgeId,this.selected.push(t))}else this.predelete=!1},async postLike(){const e=this.selected;if(3==e.length){this.predelete&&await Z.deleteLike();for(let t of e){void 0===t.reason&&(t.reason=""),void 0===t.comment&&(t.comment="");let e={knowledgeId:t.id,reason:t.reason,comment:t.comment};await Z.createLike(e)}this.message="投票ありがとうございました。期日までは何回でもやり直しできます。"}else this.message="３つ選んでください"},save(){this.snack=!0,this.snackColor="success",this.snackText="Data saved"},cancel(){this.snack=!0,this.snackColor="error",this.snackText="Canceled"},open(){this.snack=!0,this.snackColor="info",this.snackText="Dialog opened"},close(){}}},te=ee,ne=n("62ad"),ae=n("8fea"),se=n("7679"),oe=n("67b6"),re=n("43a6"),ie=n("0fd9"),le=Object(u["a"])(te,F,q,!1,null,null,null),ce=le.exports;p()(le,{VBtn:g["a"],VCol:ne["a"],VDataTable:ae["a"],VEditDialog:se["a"],VRadio:oe["a"],VRadioGroup:re["a"],VRow:ie["a"],VTextField:L["a"]});var ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.knowledges,"item-key":"id","sort-by":["count"],"sort-desc":[!0],loading:e.isLoading},scopedSlots:e._u([{key:"item.title",fn:function(t){return[n("router-link",{attrs:{to:{name:"voteresultbyid",params:{id:t.item.id}}}},[e._v(e._s(t.item.title))])]}}])})],1)],1)},de=[];const pe=X.get("knowledge"),me=X.get("like");var he={data(){return{headers:[{text:"タイトル",value:"title"},{text:"作成者",value:"author"},{text:"獲得数",value:"count"}],isLoading:!1,likes:[],knowledges:[]}},created(){this.fetch(),this.likefetch()},methods:{async fetch(){this.isLoading=!0;const{data:e}=await pe.get();for(let t in e)e[t].count=0;this.isLoading=!1,this.knowledges=e},async likefetch(){const{data:e}=await me.get();this.likes=e;for(let t in this.knowledges)this.likes.forEach(e=>{this.knowledges[t].id===e.knowledgeId&&this.$set(this.knowledges[t],"count",this.knowledges[t].count+1)})}}},ge=he,ve=Object(u["a"])(ge,ue,de,!1,null,null,null),fe=ve.exports;p()(ve,{VCol:ne["a"],VDataTable:ae["a"],VRow:ie["a"]});var ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.likes,"item-key":"id",loading:e.isLoading},scopedSlots:e._u([{key:"top",fn:function(){},proxy:!0}])})],1)],1)},be=[];const we=X.get("like");var ye={data(){return{headers:[{text:"理由",value:"reason"},{text:"コメント",value:"comment"}],isLoading:!1,likes:[]}},created(){this.likefetch()},methods:{async likefetch(){const{data:e}=await we.getByKnowledgeID(this.$route.params.id);this.likes=e}}},xe=ye,_e=Object(u["a"])(xe,ke,be,!1,null,null,null),Se=_e.exports;p()(_e,{VCol:ne["a"],VDataTable:ae["a"],VRow:ie["a"]}),a["a"].use(x["a"]);const Ve=new x["a"]({mode:"history",base:"/",routes:[{path:"/signin",name:"signin",component:R},{path:"/signup",name:"signup",component:B},{path:"/",name:"voteknowledge",component:ce,meta:{requiresAuth:!0}},{path:"/kekka",name:"voteresult",component:fe,meta:{requiresAuth:!0}},{path:"/kekka/:id",name:"voteresultbyid",component:Se,meta:{requiresAuth:!0}}]});var Ie=Ve;Ve.beforeEach((e,t,n)=>{if(e.matched.some(e=>e.meta.requiresAuth)){if(""!=localStorage.getItem("token"))return i.commit("auth/setSignIn",!0),void n();n("/signin")}n()});n("d1e7");var $e=n("f309");a["a"].use($e["a"]);var Ce=new $e["a"]({icons:{iconfont:"mdi"}});a["a"].config.productionTip=!1,new a["a"]({router:Ie,store:i,vuetify:Ce,render:e=>e(y)}).$mount("#app")}});
//# sourceMappingURL=app.94ecc878.js.map